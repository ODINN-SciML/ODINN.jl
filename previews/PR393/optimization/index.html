<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Optimization · ODINN.jl</title><meta name="title" content="Optimization · ODINN.jl"/><meta property="og:title" content="Optimization · ODINN.jl"/><meta property="twitter:title" content="Optimization · ODINN.jl"/><meta name="description" content="Documentation for ODINN.jl."/><meta property="og:description" content="Documentation for ODINN.jl."/><meta property="twitter:description" content="Documentation for ODINN.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="ODINN.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ODINN.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../quick_start/">Quick start</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../forward_simulation/">Forward simulation</a></li><li><a class="tocitem" href="../functional_inversion/">Functional inversion</a></li><li><a class="tocitem" href="../laws/">Laws</a></li><li><a class="tocitem" href="../vjp_laws/">VJP law customization</a></li><li><a class="tocitem" href="../input_laws/">Laws inputs</a></li></ul></li><li><span class="tocitem">How to use ODINN</span><ul><li><a class="tocitem" href="../parameters/">Parameters</a></li><li><a class="tocitem" href="../glaciers/">Glaciers</a></li><li><a class="tocitem" href="../models/">Models</a></li><li><a class="tocitem" href="../results_plotting/">Results and plotting</a></li><li><a class="tocitem" href="../api/">API</a></li></ul></li><li><span class="tocitem">Inversions</span><ul><li><a class="tocitem" href="../inversions/">Inversion types</a></li><li class="is-active"><a class="tocitem" href>Optimization</a><ul class="internal"><li><a class="tocitem" href="#Loss-functions"><span>Loss functions</span></a></li></ul></li><li><a class="tocitem" href="../sensitivity/">Sensitivity analysis</a></li></ul></li><li><a class="tocitem" href="../contribute/">How to contribute</a></li><li><a class="tocitem" href="../changes_plans/">Ongoing changes and future plans</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Inversions</a></li><li class="is-active"><a href>Optimization</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Optimization</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ODINN-SciML/ODINN.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ODINN-SciML/ODINN.jl/blob/main/docs/src/optimization.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Optimization"><a class="docs-heading-anchor" href="#Optimization">Optimization</a><a id="Optimization-1"></a><a class="docs-heading-anchor-permalink" href="#Optimization" title="Permalink"></a></h1><p>In this section, we discuss the aspects of the inversions related to parameter or model state optimization and the associated loss functions.</p><h2 id="Loss-functions"><a class="docs-heading-anchor" href="#Loss-functions">Loss functions</a><a id="Loss-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Loss-functions" title="Permalink"></a></h2><p>The loss function that is being optimized <span>$\mathcal{L}$</span> consists of a data fidelity term <span>$\mathcal{D}$</span> and an optional regularization term <span>$\mathcal{R}$</span>. The data fidelity term represents the empirical error between the predicted state of the glacier (given by the simulated forward model) and observations. The state of the glacier can be characterized by the thickness <span>$H$</span> and/or the ice surface velocity <span>$V$</span>. The ground truth for each of these variables is available through different datasets. On both cases, the objective is to find the value of the model parameters (e.g, the weights of the neural network, the initial state of the glacier), that minimize the total loss.</p><p>We distinguish between the contributions of the loss function that include observations (empirical loss) and regularization losses that penalize non-smoothness on the solutions. The total loss function is given by</p><p class="math-container">\[L(\theta)
=
\lambda_1 L_1(\theta)
+ \ldots
\lambda_k L_k(\theta),\]</p><p>where each <span>$L_i$</span> is a different contribution to the loss (either empirical or regularization) weighted by an hyperparameter <span>$\lambda_i$</span>. ODINN supports multiobjective loss functions thought <code>MultiLoss</code>. For example, an objective function consisting of one empirical loss function corresponding to differences in ice thickness and a regularization of the ice surface velocity can be defined as follows</p><pre><code class="language-julia hljs">loss = MultiLoss(
    losses=(LossH(), VelocityRegularization()),
    λs=(0.4, 1e-5)
    )</code></pre><p>In the following sections, we introduce how to define empirical and regularization loss terms, respectively.</p><h3 id="Empirical-loss-functions"><a class="docs-heading-anchor" href="#Empirical-loss-functions">Empirical loss functions</a><a id="Empirical-loss-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Empirical-loss-functions" title="Permalink"></a></h3><p>The empirical error can be as simple as the squared sum or the error between model and observations, but it can also involve more complex cost functions. The complete description of the different losses are available in their corresponding docstrings but we provide here a brief summary for each of them.</p><p>There are very simple types which are agnostic to the nature of the variables whose error is being computed (that is <span>$H$</span> or <span>$V$</span>). These are:</p><ul><li><code>L2Sum</code>: <span>$L^2$</span> sum of the error inside the glacier.</li><li><code>LogSum</code>: Logarithmic sum of the ration between ice surface velocities (see [<a href="../references/#morlighem_inversion_2013">3</a>]).</li></ul><p>These types which define very simple operations are used in more complex loss functions:</p><ul><li><code>LossH</code>: Loss function over the ice thickness only.</li><li><code>LossV</code>: Loss function over the ice surface velocity only.</li><li><code>LossHV</code>: Loss function over both the ice thickness and ice surface velocity.</li></ul><p>The loss function for the ice thickness <span>$H$</span> (similar for ice surface velocity <span>$V$</span>) is mathematically defined as:</p><p class="math-container">\[L(\theta)
=
\int_{t\in\mathcal{T}} \int_{x\in\Omega} \ell(H(x, t; \theta), \theta) dt d\Omega\]</p><p>where <span>$\Omega\subset\mathbb{R}^2$</span> defines the spatial domain where we evaluate the loss (usually this corresponds to areas within the glacier that are at least at a given distance from the borders), and <span>$\ell(\hat H(x, t), \theta)$</span> is the point evaluated loss function. In the case of the <span>$L^2$</span> loss, we simply have </p><p class="math-container">\[\ell(H(x, t; \theta), \theta) = \left(\hat H(t, x) - H(t, x)\right)_2^2.\]</p><p>In the formula above, <span>$\hat H$</span> and <span>$H$</span> are written as continuous variables, function of both space and time. In practice, the iceflow equation is solved on a given grid <span>$(x_i)_{i\leq I}$</span> where each <span>$x_i\in\mathbb{R}^2$</span>.</p><p>However, since we have very sparse observations, data is available only at specific points in time and space.  The ground truth ice thickness, generally coming from ground penetrating radar (GPR) field work from the Glathida database [<a href="../references/#welty_worldwide_2020">4</a>], displays a very strong sparsity, with observations concentrated along radar transects. Glacier ice surface velocity products , e.g. [<a href="../references/#millan_ice_2022">5</a>], [<a href="../references/#rabatel_satellite-derived_2023">6</a>], are notoriously less sparse, but still present many gaps in the grid due to signal-to-noise-ratio issues from the products. Let <span>$\mathcal{X}=(x_j,t_j)_{j\leq J}$</span> define the set of points where there are ground truth measurements. We assume that <span>$\forall j\leq J,\, x_j\in(x_i)_i$</span>, that is the ground truth measurements are aligned with the simulation grid. For this setting, the empirical error term can be defined as </p><p class="math-container">\[\mathcal{D}\left(\hat S, S \right) \stackrel{\mathrm{def}}{=} \sum_{j \leq J} \left( \hat H(t_j,x_j)-H(t_j,x_j) \right)^2\]</p><p>with <span>$\hat H(t_j,x_j)$</span> the predicted ice thickness at time <span>$t_j$</span> and on the node of the simulation grid <span>$x_j$</span>.</p><h3 id="Regularization"><a class="docs-heading-anchor" href="#Regularization">Regularization</a><a id="Regularization-1"></a><a class="docs-heading-anchor-permalink" href="#Regularization" title="Permalink"></a></h3><p>Regularizations are very common in inverse modelling as they help to constraint the possible solutions of the problem to physical reasonable values. From a mathematical and computational perspective, regularization losses are just another type of loss that do not include contribution from observations (and then have no <em>empirical</em> contribution to their value).</p><p>ODINN currently supports the following type of regularization, althouth the development of new regularization should be straightforward from the source code API</p><ul><li><code>TikhonovRegularization</code>: Very common in geophysical inversion. Given an linear operator <span>$A$</span>, this is given by the value of <span>$\| A(S) \|_2^2, where $S$</span> is some state variable (e.g., the ice thickness or ice surface velocity). Default choice in ODINN is the Laplacian operator.</li><li><code>InitialThicknessRegularization</code>: Penalizes large second derivatives in the initial condition of the glacier when this is treated as an optimization variable.</li></ul><p>Regularization and empirical losses can be combine together to construct new form of regularizations.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../inversions/">« Inversion types</a><a class="docs-footer-nextpage" href="../sensitivity/">Sensitivity analysis »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Friday 31 October 2025 23:17">Friday 31 October 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
