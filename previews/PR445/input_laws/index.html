<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Laws inputs · ODINN.jl</title><meta name="title" content="Laws inputs · ODINN.jl"/><meta property="og:title" content="Laws inputs · ODINN.jl"/><meta property="twitter:title" content="Laws inputs · ODINN.jl"/><meta name="description" content="Documentation for ODINN.jl."/><meta property="og:description" content="Documentation for ODINN.jl."/><meta property="twitter:description" content="Documentation for ODINN.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="ODINN.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ODINN.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../quick_start/">Quick start</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../forward_simulation/">Forward simulation</a></li><li><a class="tocitem" href="../classical_inversion/">Classical inversion</a></li><li><a class="tocitem" href="../functional_inversion/">Functional inversion</a></li><li><a class="tocitem" href="../laws/">Laws</a></li><li class="is-active"><a class="tocitem" href>Laws inputs</a><ul class="internal"><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li><li><a class="tocitem" href="#List-of-available-inputs"><span>List of available inputs</span></a></li></ul></li><li><a class="tocitem" href="../vjp_laws/">Laws VJP customization</a></li></ul></li><li><span class="tocitem">How to use ODINN</span><ul><li><a class="tocitem" href="../parameters/">Parameters</a></li><li><a class="tocitem" href="../glaciers/">Glaciers</a></li><li><a class="tocitem" href="../models/">Models</a></li><li><a class="tocitem" href="../results_plotting/">Results and plotting</a></li><li><a class="tocitem" href="../api/">API</a></li></ul></li><li><span class="tocitem">Inversions</span><ul><li><a class="tocitem" href="../inversions/">Inversion types</a></li><li><a class="tocitem" href="../optimization/">Optimization</a></li><li><a class="tocitem" href="../sensitivity/">Sensitivity analysis</a></li></ul></li><li><span class="tocitem">Community</span><ul><li><a class="tocitem" href="../contribute/">How to contribute</a></li><li><a class="tocitem" href="../code_of_conduct/">Code of conduct</a></li></ul></li><li><a class="tocitem" href="../changes_plans/">Ongoing changes and future plans</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Laws inputs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Laws inputs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ODINN-SciML/ODINN.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ODINN-SciML/ODINN.jl/blob/main/docs/src/input_laws.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Laws-inputs"><a class="docs-heading-anchor" href="#Laws-inputs">Laws inputs</a><a id="Laws-inputs-1"></a><a class="docs-heading-anchor-permalink" href="#Laws-inputs" title="Permalink"></a></h1><p>This tutorial showcases the different inputs that can be used inside the laws.</p><pre><code class="language-julia hljs">using ODINN</code></pre><p>If we represent the <code>A</code> simple rheological law that we already presented in the <a href="../laws/">Laws</a> tutorial, we can see that it depends on an input <code>T</code>, which is the long term air temperature:</p><pre><code class="language-julia hljs">params = Parameters() # Dummy parameters
nn_model = NeuralNetwork(params)
A_law = LawA(nn_model, params)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(:T,) -&gt; Array{Float64, 0}   (↧@start  custom VJP  ✅ precomputed)
</code></pre><p>The inputs of the laws are represented as objects that derive from <code>AbstractInput</code>. We have defined a subset of inputs that can be used to parameterize laws.</p><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><p>It is also possible to define new inputs by creating a new struct type and defining the method for this specific type. On top of type of the input, we also need to override three methods using multiple dispatch:</p><ul><li><code>default_name</code>: It returns a symbolic representation of the input, which is convenient to have the complete name of it.</li><li><code>get_input</code>: It computes the value of the input at a given time <code>t</code> for a specific glacier inside the simulation.</li><li><code>Base.zero</code>: It returns the zero value of the input for a specific glacier, used to generate an empty cache.</li></ul><p>For example the scalar long term air temperature is defined with the following code:</p><pre><code class="language-julia hljs">struct iAvgScalarTemp &lt;: AbstractInput end
default_name(::iAvgScalarTemp) = :averaged_scalar_long_term_temperature
function get_input(temp::iAvgScalarTemp, simulation, glacier_idx, t)
    glacier = simulation.glaciers[glacier_idx]
    return mean(glacier.climate.longterm_temps_scalar)
end
function Base.zero(temp::iAvgScalarTemp, simulation, glacier_idx)
    glacier = simulation.glaciers[glacier_idx]
    return zero(glacier.climate.longterm_temps_scalar)
end</code></pre><p>An input can compute a physical quantity which is not already defined in the iceflow model like the long term air temperature above, but it can also re-use existing variables. This is the case of the surface slope <code>∇S</code>. It is retrieved simply by returning the cached variable that lives in the iceflow model:</p><pre><code class="language-julia hljs">struct i∇S &lt;: AbstractInput end
default_name(::i∇S) = :∇S
function get_input(::i∇S, simulation, glacier_idx, t)
    return simulation.cache.iceflow.∇S
end
function Base.zero(::i∇S, simulation, glacier_idx)
    (; nx, ny) = simulation.glaciers[glacier_idx]
    return zeros(nx - 1, ny - 1)
end</code></pre><div class="admonition is-warning" id="Warning-9a1570e96907722f"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-9a1570e96907722f" title="Permalink"></a></header><div class="admonition-body"><p>Keep in mind that if you define new inputs, this will work only for forward simulations. As soon as you do inversions with custom gradient computation (that is not with SciMLSensitivity), this requires a careful rooting of the gradient and you need to implement more than simply defining new inputs that depend on the glacier state. This is considered as a very advanced feature and we recommend that you seek assistance in this case.</p></div></div><h2 id="List-of-available-inputs"><a class="docs-heading-anchor" href="#List-of-available-inputs">List of available inputs</a><a id="List-of-available-inputs-1"></a><a class="docs-heading-anchor-permalink" href="#List-of-available-inputs" title="Permalink"></a></h2><p>For the moment we support the following list of inputs:</p><ul><li>Scalar averaged long term air temperature</li></ul><article><details class="docstring" open="true"><summary id="Huginn.iAvgScalarTemp"><a class="docstring-binding" href="#Huginn.iAvgScalarTemp"><code>Huginn.iAvgScalarTemp</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">iAvgScalarTemp &lt;: AbstractInput</code></pre><p>Input that represents the long term air temperature over the whole glacier. It is computed using the OGGM climate data over a period predefined in Gungnir (i.e. around 30 years).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ODINN-SciML/Huginn.jl/blob/v0.12.5/src/laws/Inputs.jl#L5-L10">source</a></section></details></article><pre><code class="language-julia hljs">iAvgScalarTemp()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">averaged_long_term_temperature: iAvgScalarTemp()</code></pre><ul><li>Gridded averaged long term air temperature</li></ul><article><details class="docstring" open="true"><summary id="Huginn.iAvgGriddedTemp"><a class="docstring-binding" href="#Huginn.iAvgGriddedTemp"><code>Huginn.iAvgGriddedTemp</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">iAvgGriddedTemp &lt;: AbstractInput</code></pre><p>Input that represents the long term air temperature over the glacier grid. It is computed using the OGGM climate data over a period predefined in Gungnir (i.e. around 30 years).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ODINN-SciML/Huginn.jl/blob/v0.12.5/src/laws/Inputs.jl#L23-L28">source</a></section></details></article><pre><code class="language-julia hljs">iAvgGriddedTemp()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">gridded_long_term_temperature: iAvgGriddedTemp()</code></pre><ul><li>Cumulative positive degree days (PDD)</li></ul><article><details class="docstring" open="true"><summary id="Huginn.iCPDD"><a class="docstring-binding" href="#Huginn.iCPDD"><code>Huginn.iCPDD</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">iCPDD &lt;: AbstractInput</code></pre><p>Input that represents the cumulative positive degree days (PDD) over the last time window <code>window</code>. It is computed by summing the daily PDD values from <code>t - window</code> to <code>t</code> using the glacier&#39;s climate data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ODINN-SciML/Huginn.jl/blob/v0.12.5/src/laws/Inputs.jl#L41-L46">source</a></section></details></article><pre><code class="language-julia hljs">iCPDD()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">CPDD: iCPDD{Dates.Week}(Dates.Week(1))</code></pre><ul><li>Ice thickness on the dual grid in the SIA</li></ul><article><details class="docstring" open="true"><summary id="Huginn.iH̄"><a class="docstring-binding" href="#Huginn.iH̄"><code>Huginn.iH̄</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">iH̄ &lt;: AbstractInput</code></pre><p>Input that represents the ice thickness in the SIA. It is the averaged ice thickness computed on the dual grid, that is <code>H̄ = avg(H)</code> which is different from the ice thickness solution H.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ODINN-SciML/Huginn.jl/blob/v0.12.5/src/laws/Inputs.jl#L72-L78">source</a></section></details></article><pre><code class="language-julia hljs">iH̄()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">H_dual_grid: iH̄()</code></pre><ul><li>Surface slope</li></ul><article><details class="docstring" open="true"><summary id="Huginn.i∇S"><a class="docstring-binding" href="#Huginn.i∇S"><code>Huginn.i∇S</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">i∇S &lt;: AbstractInput</code></pre><p>Input that represents the surface slope in the SIA. It is computed using the bedrock elevation and the ice thickness solution H. The spatial differences are averaged over the opposite axis:</p><pre><code class="language-julia hljs">S = B + H
∇S = (avg_y(diff_x(S) / Δx) .^ 2 .+ avg_x(diff_y(S) / Δy) .^ 2) .^ (1/2)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ODINN-SciML/Huginn.jl/blob/v0.12.5/src/laws/Inputs.jl#L89-L100">source</a></section></details></article><pre><code class="language-julia hljs">i∇S()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">∇S: i∇S()</code></pre><ul><li>Topographic roughness</li></ul><article><details class="docstring" open="true"><summary id="Huginn.iTopoRough"><a class="docstring-binding" href="#Huginn.iTopoRough"><code>Huginn.iTopoRough</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">iTopoRough{F&lt;:AbstractFloat} &lt;: AbstractInput</code></pre><p>Input that represents the topographic roughness of the glacier. It is computed as the curvature of the glacier bed (or surface) over a specified window size. The curvature can be calculated in different directions (flow, cross-flow, or both) and using different curvature types (scalar or variability).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ODINN-SciML/Huginn.jl/blob/v0.12.5/src/laws/Inputs.jl#L111-L117">source</a></section></details></article><pre><code class="language-julia hljs">iTopoRough()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">topographic_roughness: iTopoRough{Float64}(200.0, :scalar, :flow, :bed)</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../laws/">« Laws</a><a class="docs-footer-nextpage" href="../vjp_laws/">Laws VJP customization »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Thursday 4 December 2025 22:21">Thursday 4 December 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
